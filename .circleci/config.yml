version: 2.1

orbs:
  # g33io-dev-repos: orbinoid2/gravitee-dev-repos@0.0.3
  g33io-dev-repos: orbinoid2/gravitee-dev-repos@0.0.1

parameters:
  g33io_to:
    type: string
    # the [default:] clause is required : without it, a Circle CI error will occur
    # default: none
    # the [default:] clause must have a valid value : without a valid value, a Circle CI error will occur
    default: "Gravitee.io Team!"

jobs:
  build:
    docker:
      - image: "circleci/node:latest"
    environment:
      PARAM_TO: "Gravitee.io Team!"
    steps:
      - checkout
      # So I will need to invoke this pipeline with a "to" parameter set to "The Great Gravitee Team!"
      # to pass on the value to the orb command execution
      - g33io-dev-repos/greet:
          to: "Gravitee Mates :) !!"
      - run:
          name: install
          command: npm ci
      - run:
          name: validate
          command: npm run validate
      - run:
          name: release
          command: echo installing semantic-release && npx -p semantic-release@15 -c 'echo running semantic-release && semantic-release'
